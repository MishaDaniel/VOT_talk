---
title: "Daghestanian stops"
subtitle: "VOT, CD and other stories"
author: "M. Daniel, S. Grawunder, G. Moroz, V. Zhigulskaya"
date: "2017/10/03"
output:
  xaringan::moon_reader:
    css: ["default", "my_theme.css"]
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(echo = FALSE,
                      message=FALSE,
                      warning= FALSE,
                      fig.width=10.4,
                      fig.height=7)
library(tidyverse)
library(lingtypology)
library(ggjoy)
```

class: inverse, center, middle

# Motivation

---

# Introduction
Mehweb speaker: **q'ap'a** ‘lid’ 
<audio controls>
  <source src="https://raw.githubusercontent.com/agricolamz/VOT_talk/master/docs/a_mehweb_q'ap'a.WAV" type="audio/wav">
</audio>

Zilo speaker: **bot'i** ‘blind’ 
<audio controls>
  <source src="https://raw.githubusercontent.com/agricolamz/VOT_talk/master/docs/a_zilo_bot'i.WAV" type="audio/wav">
</audio>

---
class: inverse, center, middle

# Data

---
# Villages

```{r}
df <- read_csv("speakers.csv")
df %>% 
  distinct(Language, Location, lon, lat, color) -> 
  df_u
map.feature(df_u$Language,
            features = df_u$Language,
            tile = "Esri.OceanBasemap",
            label = df_u$Location,
            label.hide = FALSE,
            label.fsize = 19,
            longitude = df_u$lon,
            latitude = df_u$lat,
            minimap = TRUE,
            minimap.position = "topleft",
            color = df_u$color)
```
---
# Speakers by village
```{r}
df %>% 
  count(Location) %>% 
  full_join(df) %>% 
  mutate(`(all)` = n) %>% 
  count(Location, `(all)`, Gender) %>% 
  spread(Gender, nn) %>% 
  mutate(f = ifelse(is.na(f), 0, f)) %>% 
  gather(Gender, n, `(all)`:m) ->
  annotation

df %>% 
  count(Location, Gender) %>% 
  full_join(df) %>% 
  filter(!is.na(Age)) ->
  df_plot

df_plot[,-2] %>% 
  mutate(Gender = "(all)") ->
  df_plot2

df_plot %>% 
  ggplot(aes(x = Age, y = Location)) +
  geom_joy(aes(fill = Gender), alpha = 0.6, show.legend = FALSE) +
  geom_joy(data = df_plot2, aes(fill = Gender), alpha = 0.6, show.legend = FALSE) +
  geom_text(data = annotation, aes(label = n, x = 2030), size = 8)+
  theme_bw()+
  facet_grid(~Gender)+
  theme(text = element_text(size=20))+
  labs(y = "", x = "",
       title = "Year of birth")+
  scale_x_continuous(breaks = 1:4*30+1890)
```
---
# Speakers by language
```{r}
df %>% 
  count(Language) %>% 
  full_join(df) %>% 
  mutate(`(all)` = n) %>% 
  count(Language, `(all)`, Gender) %>% 
  spread(Gender, nn) %>% 
  mutate(f = ifelse(is.na(f), 0, f)) %>% 
  gather(Gender, n, `(all)`:m) ->
  annotation

df %>% 
  count(Language, Gender) %>% 
  full_join(df) %>% 
  filter(!is.na(Age)) ->
  df_plot

df_plot[,-2] %>% 
  mutate(Gender = "(all)") ->
  df_plot2

df_plot %>% 
  ggplot(aes(x = Age, y = Language)) +
  geom_joy(aes(fill = Gender), alpha = 0.6, show.legend = FALSE) +
  geom_joy(data = df_plot2, aes(fill = Gender), alpha = 0.6, show.legend = FALSE) +
  geom_text(data = annotation, aes(label = n, x = 2030), size = 8)+
  theme_bw()+
  facet_grid(~Gender)+
  theme(text = element_text(size=20))+
  labs(y = "", x = "",
       title = "Year of birth")+
  scale_x_continuous(breaks = 1:4*30+1890)
```

---
# Features of stops and affricates

- **POA**: labial; dental; lateral; postalveolar; velar; uvular
- **manner**: stops; affricates
- **phonation type**: voiced; voiceless; ejective
- **gemination**
- **labialization**
- **pharyngealization**
- **phonological context**: initial; medial
- **type of utterance**: first; second; third; carrier phrases

---
# Measurments

- Closure Duration (CD)
- Voice Oncet Time (VOT)
  - Fricative part (FP)
  - Postfricative part (PF)
- Folowing vowel duration
  - Creacky voice part of the vowel (CV)
  - Modal Voice part (M)
- Intencity contour

---
# Measurments

The word **kʷatʃʼa** ‘paw’ by Zilo speaker m_12:

![](https://raw.githubusercontent.com/agricolamz/VOT_talk/master/docs/annotation_example.png)

---
# Lists of words


---
class: inverse, center, middle

# Annotation

---
class: inverse, center, middle

# Results
---
# Analysis

- Annotation in Praat
- Data extraction with [**Praat Script**](https://raw.githubusercontent.com/agricolamz/VOT_talk/master/Lennes%2C%20Moroz%20duration%2C%20info%20from%20other%20tier%20and%20some%20prefix%202%20tsv.praat)
- Data analysis and visulization [**with R**](https://raw.githubusercontent.com/agricolamz/VOT_talk/master/docs/index.Rmd)

---
# Absolute values of VOT and CD
```{r}
results <- read_tsv("result.tsv", col_names = FALSE)
colnames(results) <- c("speaker", "stimulus", "sound", "utterance", "s_parts", "duration", "start", "end")

results %>% 
  mutate(POA = ifelse(grepl("[bp]", sound), "labial", "")) %>% 
  mutate(POA = ifelse(grepl("[dts]", sound), "dental", POA)) %>%
  mutate(POA = ifelse(grepl("ɬ", sound), "lateral", POA)) %>%
  mutate(POA = ifelse(grepl("tʃ|dʒ", sound), "postalveolar", POA)) %>%
  mutate(POA = ifelse(grepl("[kgɡ]", sound), "velar", POA)) %>%
  mutate(POA = ifelse(grepl("[qɢ]", sound), "uvular", POA)) %>%
  mutate(POA = factor(POA, levels = c("labial", "dental", "lateral", "postalveolar", "velar", "uvular"))) %>% 
  mutate(manner = ifelse(grepl("ts|tʃ|tɬ|dʒ|qχ", sound), "affricate", "plosive")) %>% 
  mutate(manner = ifelse(grepl("[aiuoeɨ]", sound), "vowel", manner)) %>% 
  mutate(type = ifelse(grepl("[bdgɡɢ]", sound), "voiced", "voiceless")) %>% 
  mutate(type = ifelse(manner == "vowel", "vowel", type)) %>% 
  mutate(type = ifelse(grepl("'", sound), "ejective", type)) %>% 
  mutate(geminate = ifelse(grepl("[:ː]", sound), "geminate", "")) %>% 
  mutate(labialization = ifelse(grepl("ʷ", sound), "labialized", "")) %>% 
  mutate(pharyngealization = ifelse(grepl("ˤ", sound), "pharyngealized", "")) ->
  results

results %>% 
  select(sound) %>% 
  slice(-1) %>% 
  mutate(s_identical = . == results[-nrow(results),"sound"]) %>% 
  select(s_identical) %>% 
  add_row(s_identical = FALSE, .before = 1) %>% 
  unlist() ->
  results$same_sound

results %>% 
  select(utterance) %>% 
  slice(-1) %>% 
  mutate(ut_identical = . == results[-nrow(results),"utterance"]) %>% 
  select(ut_identical) %>% 
  add_row(ut_identical = FALSE, .before = 1) %>% 
  unlist() ->
  results$same_utterance

results %>% 
  mutate(ut_type = ifelse(same_utterance, "medial", "initial")) %>% 
  mutate(ut_type = ifelse(same_sound, c("NA", ut_type), ut_type)) %>%
  mutate(ut_type = ifelse(manner == "vowel", c("", ut_type), ut_type)) %>% 
  select(-same_sound, -same_utterance) %>% 
  mutate(sound_m = ifelse(manner == "vowel", sound[-1], sound))->
  results

results %>% 
  spread(s_parts, duration) %>% 
  select(-start, -end) %>%
  mutate_all(funs(replace(., is.na(.), 0))) %>% 
  group_by(speaker, stimulus, utterance, sound_m, POA, manner, type, geminate, labialization, pharyngealization, ut_type) %>% 
  summarise(cd = sum(cd),
            cv = sum(cv),
            f = sum(f),
            m = sum(m),
            pf = sum(pf)) %>% 
  mutate(vot = f + pf,
         whole_vowel = cv + m) %>% 
  filter(manner != "vowel",
         ut_type != "initial") %>% 
ggplot(aes(cd, vot, color = type))+
  geom_point(size = 3)+
  theme_bw()+
  facet_wrap(~POA)+
  theme(text = element_text(size=20))+
  labs(y = "VOT",
       x = "CD",
       caption = paste("Based on",
                       length(unique(results$speaker)),
                       "speaker"))
```

---

class: center, middle

# Thanks!

M. Daniel (misha.daniel@gmail.com)

S. Grawunder (grawunder@eva.mpg.de )

G. Moroz (agricolamz@gmail.com)

V. Zhigulskaya (vasilek224@bk.ru)

Slides created with the following R packages:

[**ggjoy**](https://CRAN.R-project.org/package=ggjoy)

[**ggplot2**](http://ggplot2.org)

[**lingtypology**](https://ropensci.github.io/lingtypology/)

[**xaringan**](https://github.com/yihui/xaringan)
